{% extends 'base.html' %}
{% load static %}

{% block title %}Courses{% endblock %}

{% block content %}
<div class="container py-4">
  <div class="text-center mb-5">
    <h1 class="display-5 fw-bold text-dark mb-2">Explore Courses</h1>
    <p class="lead text-muted">Learn new skills at your own pace. Enroll for free and track your progress.</p>
  </div>

  <!-- Category filter -->
  {% if categories %}
  <div class="d-flex flex-wrap justify-content-center gap-2 mb-4">
    <a href="{% url 'courses:course_list' %}" class="btn {% if not selected_category %}btn-primary{% else %}btn-outline-primary{% endif %} btn-sm rounded-pill">
      All
    </a>
    {% for cat in categories %}
    <a href="?category={{ cat.slug }}" class="btn {% if selected_category == cat.slug %}btn-primary{% else %}btn-outline-primary{% endif %} btn-sm rounded-pill">
      {{ cat.name }}
    </a>
    {% endfor %}
  </div>
  {% endif %}

  <!-- Course grid -->
  <div class="row g-4">
    {% for course in courses %}
    <div class="col-12 col-sm-6 col-lg-4">
      <div class="card course-card h-100">
        <a href="{% url 'courses:course_detail' course.slug %}" class="text-decoration-none text-dark">
          {% if course.thumbnail %}
          <img src="{{ course.thumbnail.url }}" class="card-img-top" alt="{{ course.title }}">
          {% else %}
          <div class="card-img-top d-flex align-items-center justify-content-center bg-secondary text-white">
            <i class="bi bi-journal-bookmark-fill display-4"></i>
          </div>
          {% endif %}
          <div class="card-body">
            <span class="badge bg-secondary mb-2">{{ course.get_level_display }}</span>
            {% if course.category %}
            <span class="badge bg-light text-dark border mb-2">{{ course.category.name }}</span>
            {% endif %}
            <h5 class="card-title">{{ course.title }}</h5>
            <p class="card-text text-muted small mb-2">{{ course.description|truncatewords:15 }}</p>
            <div class="d-flex justify-content-between align-items-center text-muted small">
              <span><i class="bi bi-collection me-1"></i>{{ course.lesson_count }} lessons</span>
              <span><i class="bi bi-clock me-1"></i>{{ course.total_duration_display }}</span>
            </div>
          </div>
        </a>
      </div>
    </div>
    {% empty %}
    <div class="col-12 text-center py-5">
      <i class="bi bi-inbox display-4 text-muted"></i>
      <p class="lead text-muted mt-3">No courses available yet. Check back soon!</p>
    </div>
    {% endfor %}
  </div>

  {% if is_paginated %}
  <nav class="mt-4 d-flex justify-content-center">
    <ul class="pagination">
      {% if page_obj.has_previous %}
      <li class="page-item"><a class="page-link" href="?page={{ page_obj.previous_page_number }}{% if selected_category %}&category={{ selected_category }}{% endif %}">Previous</a></li>
      {% endif %}
      <li class="page-item disabled"><span class="page-link">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span></li>
      {% if page_obj.has_next %}
      <li class="page-item"><a class="page-link" href="?page={{ page_obj.next_page_number }}{% if selected_category %}&category={{ selected_category }}{% endif %}">Next</a></li>
      {% endif %}
    </ul>
  </nav>
  {% endif %}
</div>
{% endblock %}
